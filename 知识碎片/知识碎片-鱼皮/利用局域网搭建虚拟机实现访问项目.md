# 利用局域网搭建虚拟机实现访问项目

> 作者：[明眸゜suns](https://www.code-nav.cn/user/1693620843504050178)，[编程导航星球](https://wx.zsxq.com/dweb2/index/group/51122858222824) 编号 6096

## 经验

> 虚拟机配网

## 背景

由于有一个项目不需要（不能）对外访问，所以考虑直接搭建一个局域网的环境，让该局域网内可以直接访问这个项目
项目是前后端分离的，但尽量忽略对项目的介绍，主要围绕虚拟机、局域网访问这两个点展开详细介绍，并且附带我个人踩坑结果等

## 参照教程

参考教程为如下两篇，但每篇我按照步骤均有不同程度的报错，反正是没个痛快能解决问题的
https://blog.csdn.net/weixin_45019350/article/details/109713762
https://blog.csdn.net/weixin_41538012/article/details/115325944

## 步骤

提示：我不太懂每一步的具体原理，但是我几乎是按照网上所有教程都做过了，个人感觉可以直接配置为我的参数，选项等

### 环境如下：

宿主机：win10，虚拟机：centos7，要访问的主机为win11

可以先参考上面两篇文章，具体每一步都说的挺详细的，但是奈何我出不来结果，下面展示我的实操过程
当前步骤为：在刚安装完系统之后，使用root账户登录
安装的时候或者安装完之后选择网络适配器的模式为NAT模式

![](https://pic.yupi.icu/5563/202312141552232.png)

首先打开vmwear，选择编辑，打开虚拟网络编辑器

![](https://pic.yupi.icu/5563/202312141552242.png)

然后更改一下设置（要不然你要编辑的地方都是灰色的，为不可编辑状态），这个时候你的系统会弹出一个提示（如果没有，则忽略）选择，是

![](https://pic.yupi.icu/5563/202312141552253.png)

选择后缀为8的这个，然后先编辑2，在编辑3

![](https://pic.yupi.icu/5563/202312141552308.png)

然后先点击1，再编辑2

![](https://pic.yupi.icu/5563/202312141552323.png)

这个时候为我在局域网内访问做铺垫，在此处设置端口转发
3306端口，让我可以在外部使用图形化界面操作数据库
22端口，让我在局域网内连接虚拟机

![](https://pic.yupi.icu/5563/202312141552220.png)

确定编辑完之后，再回来编辑DHCP设置（一般不用编辑，这个时候主要是打开查看一下，刚才在外面设置的那个子网ip对不对）确认子网ip为刚才我们设置的子网ip
并且查看起始和结束地址为128~254（待会虚拟机配置文件的ip必须得在这个范围之内）

![](https://pic.yupi.icu/5563/202312141555848.png)

最后确定这几个地方参数没问题点击确定就行

![](https://pic.yupi.icu/5563/202312141552384.png)

然后进入虚拟机（使用root账户）

直接输入下面这行命令编辑配置文件

```bash
vi /etc/sysconfig/network-scripts/ifcfg-ens33
```

按下i键进入编辑模式 红色框框是修改的 蓝色框框是自己输入的 ![](https://pic.yupi.icu/5563/202312141552503.png)

输入完之后按esc退出，然后按住shift双击z保存并退出

然后输入这个命令重启网络

```bash
service network restart
```

![](https://pic.yupi.icu/5563/202312141552535.png)

看到ok即表示配置成功

然后配置一下这个文件，如果和我图片一样的话，就不用配置了

```bash
vi /etc/resolv.conf
```

![](https://pic.yupi.icu/5563/202312141552624.png)

到目前为止，linux虚拟机和vmwear的配置就完事了，在这个时候，因为我是局域网访问，所以我直接就把防火墙关了，这个原理类似于你自己电脑上的虚拟机，为了方便，直接关掉防火墙一样的道理

### 注意事项

一定记得关闭防火墙或者开放你需要的端口

然后开始win宿主机

右击1，的然后单击2和3，出来的界面右击4

![](https://pic.yupi.icu/5563/202312141552854.png)

然后点击属性

![](https://pic.yupi.icu/5563/202312141552178.png)

然后双击这个ipv4，输入我的参数

![](https://pic.yupi.icu/5563/202312141552315.png)

点击确定之后，从这几个方向验证以上这些配置是否成功
先查看下宿主机的ip

win+r，然后输入cmd回车，输入ipconfig 查看自己电脑的ip地址，就是我图片指向的这个 （根据每台电脑不同，有可能用的无线，有可能有限，看你自己使用的网卡是哪一个）

![](https://pic.yupi.icu/5563/202312141552472.png)

- 虚拟机上外网 ping [www.baidu.com](http://www.baidu.com/)
- 虚拟机ping宿主机 ping 宿主机地址
- 宿主机ping虚拟机 ping 虚拟机地址（如果按照我的参数，那就是刚才配置文件的ipaddr，为：192.168.95.200）

以下为成功截图

![](https://pic.yupi.icu/5563/202312141552632.png)

这个时候就表示我们的配置已经都好了

### 使用

在要访问的主机输入宿主机的IP地址，然后写你虚拟机的用户名和密码

![](https://pic.yupi.icu/5563/202312141552939.png)

然后就可以操作虚拟机啦

![](https://pic.yupi.icu/5563/202312141552048.png)

然后连接数据库，输宿主机的地址，和数据库的用户名还有密码

![](https://pic.yupi.icu/5563/202312141552227.png)